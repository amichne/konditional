"use strict";(self.webpackChunkkonditional_docs=self.webpackChunkkonditional_docs||[]).push([[184],{48193(e,n,t){t.d(n,{R:()=>l,x:()=>r});var s=t(30758);const i={},a=s.createContext(i);function l(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(a.Provider,{value:n},e.children)}},64630(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"core-concepts","title":"Core Concepts","description":"Konditional\u2019s public surface is intentionally small. Understanding three primitives\u2014Features, Context, and Namespaces\u2014is enough to reason about correctness, organization, and runtime behavior.","source":"@site/docs/core-concepts.md","sourceDirName":".","slug":"/core-concepts","permalink":"/core-concepts","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Migration Guide","permalink":"/migration"},"next":{"title":"Targeting & Ramp-ups","permalink":"/targeting-ramp-ups"}}');var i=t(86070),a=t(48193);const l={},r="Core Concepts",o={},d=[{value:"Features",id:"features",level:2},{value:"Supported types",id:"supported-types",level:3},{value:"Enums instead of strings",id:"enums-instead-of-strings",level:3},{value:"Rules",id:"rules",level:2},{value:"Custom predicates via <code>extension { }</code>",id:"custom-predicates-via-extension--",level:3},{value:"Context",id:"context",level:2},{value:"StableId (deterministic ramp-ups)",id:"stableid-deterministic-ramp-ups",level:3},{value:"Namespaces",id:"namespaces",level:2},{value:"Custom namespaces (governance)",id:"custom-namespaces-governance",level:3},{value:"Type safety in action (what becomes impossible)",id:"type-safety-in-action-what-becomes-impossible",level:2},{value:"Wrong value type at call site",id:"wrong-value-type-at-call-site",level:3},{value:"Wrong context type for a feature",id:"wrong-context-type-for-a-feature",level:3},{value:"Next steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"core-concepts",children:"Core Concepts"})}),"\n",(0,i.jsxs)(n.p,{children:["Konditional\u2019s public surface is intentionally small. Understanding three primitives\u2014",(0,i.jsx)(n.strong,{children:"Features"}),", ",(0,i.jsx)(n.strong,{children:"Context"}),", and ",(0,i.jsx)(n.strong,{children:"Namespaces"}),"\u2014is enough to reason about correctness, organization, and runtime behavior."]}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TD\n    N["Namespace"] --\x3e R["Registry"]\n    N --\x3e F["Feature (typed)"]\n    F --\x3e D["Default (required)"]\n    F --\x3e Rules["Rules"]\n    Rules --\x3e Rule["rule(value) { ... }"]\n    Rule --\x3e Criteria["platforms/locales/versions/axis/rampUp/allowlist/extension"]\n    X["Context"] --\x3e Rule'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,i.jsxs)(n.p,{children:["A feature is a typed configuration value with an optional rule set. You define features as delegated properties on a\n",(0,i.jsx)(n.code,{children:"Namespace"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'import io.amichne.konditional.api.evaluate\nimport io.amichne.konditional.context.Context\nobject AppFeatures : Namespace("app") {\n    val darkMode by boolean<Context>(default = false)\n    val apiEndpoint by string<Context>(default = "https://api.example.com")\n    val maxRetries by integer<Context>(default = 3)\n    val timeoutSeconds by double<Context>(default = 30.0)\n}\n\nval enabled: Boolean = AppFeatures.darkMode.evaluate(context)\nval endpoint: String = AppFeatures.apiEndpoint.evaluate(context)\n'})}),"\n",(0,i.jsx)(n.p,{children:"What this buys you:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Property name becomes the key"})," (no string keys at call sites)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type flows from the delegate"})," (",(0,i.jsx)(n.code,{children:"boolean"})," \u2192 ",(0,i.jsx)(n.code,{children:"Boolean"}),", etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Non-null evaluation"})," (default is required)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"supported-types",children:"Supported types"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Namespace method"}),(0,i.jsx)(n.th,{children:"Kotlin type"}),(0,i.jsx)(n.th,{children:"Example default"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Boolean"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"boolean(...)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Boolean"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"false"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string(...)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"String"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"production"'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"integer(...)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Int"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"42"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Decimal"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"double(...)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Double"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"3.14"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Enum"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"enum(...)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"E : Enum<E>"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LogLevel.INFO"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Data class"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"custom(...)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"T : KotlinEncodeable<ObjectSchema>"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"MyConfig()"})})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Custom data classes are decoded via Kotlin reflection at the JSON boundary. Ensure Kotlin reflection is available\nat runtime (Konditional bundles it), and keep constructor parameter names stable when using obfuscation."}),"\n",(0,i.jsx)(n.h3,{id:"enums-instead-of-strings",children:"Enums instead of strings"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'enum class LogLevel { DEBUG, INFO, WARN, ERROR }\nenum class Theme { LIGHT, DARK, AUTO }\n\nobject AppConfig : Namespace("app-config") {\n    val LOG_LEVEL by enum<LogLevel, Context>(default = LogLevel.INFO)\n    val THEME by enum<Theme, Context>(default = Theme.LIGHT)\n}\n\nval level: LogLevel = AppConfig.LOG_LEVEL.evaluate(context)\n'})}),"\n",(0,i.jsx)(n.p,{children:"Because variants are enum values, invalid variants cannot compile."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"rules",children:"Rules"}),"\n",(0,i.jsx)(n.p,{children:"Rules are a typed mapping from a set of criteria to a concrete return value:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val apiEndpoint by string<Context>(default = "https://api.example.com") {\n    rule("https://api-ios.example.com") { platforms(Platform.IOS) }\n    rule("https://api-android.example.com") { platforms(Platform.ANDROID) }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Criteria you can compose (within a single rule):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"platforms(...)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"locales(...)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"versions { min(...); max(...) }"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"rampUp { percent }"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowlist(...)"})," (ramp-up bypass)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"axis(...)"})," (dimensional targeting)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"extension { ... }"})," for custom predicates"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Within a rule, criteria combine as ",(0,i.jsx)(n.strong,{children:"AND"}),": all specified criteria must match for the rule to match."]}),"\n",(0,i.jsxs)(n.h3,{id:"custom-predicates-via-extension--",children:["Custom predicates via ",(0,i.jsx)(n.code,{children:"extension { }"})]}),"\n",(0,i.jsxs)(n.p,{children:["To keep business targeting logic typed (not string-based), define a custom ",(0,i.jsx)(n.code,{children:"Context"})," and use ",(0,i.jsx)(n.code,{children:"extension { }"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'data class EnterpriseContext(\n    override val locale: AppLocale,\n    override val platform: Platform,\n    override val appVersion: Version,\n    override val stableId: StableId,\n    val subscriptionTier: SubscriptionTier,\n    val employeeCount: Int\n) : Context\n\nenum class SubscriptionTier { FREE, PRO, ENTERPRISE }\n\nobject PremiumFeatures : Namespace("premium") {\n    val ADVANCED_ANALYTICS by boolean<EnterpriseContext>(default = false) {\n        rule(true) {\n            extension { subscriptionTier == SubscriptionTier.ENTERPRISE && employeeCount > 100 }\n        }\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Because the feature is parameterized with ",(0,i.jsx)(n.code,{children:"EnterpriseContext"}),", the receiver inside ",(0,i.jsx)(n.code,{children:"extension { ... }"})," is strongly\ntyped."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,i.jsx)(n.p,{children:"Context provides evaluation inputs: it tells Konditional who is asking and where they are."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"locale"})," and ",(0,i.jsx)(n.code,{children:"platform"})," are modeled as stable identifiers via ",(0,i.jsx)(n.code,{children:"LocaleTag"})," and ",(0,i.jsx)(n.code,{children:"PlatformTag"}),". Use the built-in\n",(0,i.jsx)(n.code,{children:"AppLocale"})," / ",(0,i.jsx)(n.code,{children:"Platform"})," enums or supply your own types with stable ",(0,i.jsx)(n.code,{children:"id"})," values."]}),"\n",(0,i.jsx)(n.p,{children:"Standard fields (the minimum required by the rule DSL):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val context = Context(\n    locale = AppLocale.UNITED_STATES,\n    platform = Platform.IOS,\n    appVersion = Version.of(2, 1, 0),\n    stableId = StableId.of("user-123"),\n)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"stableid-deterministic-ramp-ups",children:"StableId (deterministic ramp-ups)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"stableId"})," is a stable identifier used for deterministic bucketing.\n",(0,i.jsx)(n.code,{children:"StableId.of(...)"})," accepts any non-blank string and normalizes it to a hex representation used for bucketing."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val id = StableId.of("user-123")\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If you need cross-platform consistency, ensure all platforms pass the same canonical stable identifier string\ninto ",(0,i.jsx)(n.code,{children:"StableId.of(...)"})," (it lowercases using ",(0,i.jsx)(n.code,{children:"Locale.ROOT"}),"). Use ",(0,i.jsx)(n.code,{children:"StableId.fromHex(...)"})," when you already have a\ncanonical hex identifier."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"namespaces",children:"Namespaces"}),"\n",(0,i.jsx)(n.p,{children:"Namespaces are isolation boundaries: each namespace has its own registry and independent configuration lifecycle.\nDefine multiple namespaces when you need more isolation boundaries."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'sealed class AppDomain(id: String) : Namespace(id) {\n    data object Auth : AppDomain("auth") {\n        val socialLogin by boolean<Context>(default = false)\n        val twoFactorAuth by boolean<Context>(default = true)\n    }\n\n    data object Payments : AppDomain("payments") {\n        val applePay by boolean<Context>(default = false)\n        val stripeIntegration by boolean<Context>(default = true)\n    }\n}\n\nAppDomain.Auth.load(authConfig)\nAppDomain.Payments.load(paymentConfig)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"custom-namespaces-governance",children:"Custom namespaces (governance)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'sealed class TeamDomain(id: String) : Namespace(id) {\n    data object Recommendations : TeamDomain("recommendations") {\n        val COLLABORATIVE_FILTERING by boolean(default = true)\n    }\n\n    data object Analytics : TeamDomain("analytics")\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:"TeamDomain.Recommendations.COLLABORATIVE_FILTERING.evaluate(context)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Each namespace has independent configuration lifecycle, registry, and serialization."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"type-safety-in-action-what-becomes-impossible",children:"Type safety in action (what becomes impossible)"}),"\n",(0,i.jsx)(n.h3,{id:"wrong-value-type-at-call-site",children:"Wrong value type at call site"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'object Config : Namespace("config") {\n    val maxRetries by integer<Context>(default = 3)\n}\n\nval retries: Int = Config.maxRetries.evaluate(context)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"wrong-context-type-for-a-feature",children:"Wrong context type for a feature"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:"val basicContext: Context = Context(...)\nPremiumFeatures.ADVANCED_ANALYTICS.evaluate(basicContext) // Compile error (requires EnterpriseContext)\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Understand rule composition and ramp-ups: ",(0,i.jsx)(n.a,{href:"/targeting-ramp-ups",children:'"Targeting & Ramp-ups"'})]}),"\n",(0,i.jsxs)(n.li,{children:["Understand evaluation order and determinism: ",(0,i.jsx)(n.a,{href:"/evaluation",children:'"Evaluation"'})]}),"\n",(0,i.jsxs)(n.li,{children:["Understand the runtime JSON boundary: ",(0,i.jsx)(n.a,{href:"/remote-config",children:'"Remote Configuration"'})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);