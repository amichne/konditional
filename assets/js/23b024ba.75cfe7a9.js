"use strict";(self.webpackChunkkonditional_docs=self.webpackChunkkonditional_docs||[]).push([[461],{48193(e,n,t){t.d(n,{R:()=>a,x:()=>l});var s=t(30758);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},98162(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"theory","title":"Theory: What \u201cIf it compiles, it works\u201d means","description":"Konditional\u2019s core claim is intentionally narrow and testable: for statically-defined flags and rules, the compiler","source":"@site/docs/theory.md","sourceDirName":".","slug":"/theory","permalink":"/theory","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Remote Configuration","permalink":"/remote-config"},"next":{"title":"Persistence & Storage Format","permalink":"/persistence-format"}}');var r=t(86070),i=t(48193);const a={},l="Theory: What \u201cIf it compiles, it works\u201d means",d={},o=[{value:"The three failures of stringly-typed flags",id:"the-three-failures-of-stringly-typed-flags",level:2},{value:"Mechanism 1: Property delegation binds identity + type",id:"mechanism-1-property-delegation-binds-identity--type",level:2},{value:"Mechanism 2: Rule return types are constrained",id:"mechanism-2-rule-return-types-are-constrained",level:2},{value:"Mechanism 3: Evaluation site preserves the concrete type",id:"mechanism-3-evaluation-site-preserves-the-concrete-type",level:2},{value:"Mechanism 4: Required defaults eliminate nulls",id:"mechanism-4-required-defaults-eliminate-nulls",level:2},{value:"Mechanism 5: Namespace isolation is structural",id:"mechanism-5-namespace-isolation-is-structural",level:2},{value:"The trust boundary: runtime JSON",id:"the-trust-boundary-runtime-json",level:2},{value:"Summary: what is guaranteed vs what is not",id:"summary-what-is-guaranteed-vs-what-is-not",level:2},{value:"Next steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"theory-what-if-it-compiles-it-works-means",children:"Theory: What \u201cIf it compiles, it works\u201d means"})}),"\n",(0,r.jsxs)(n.p,{children:["Konditional\u2019s core claim is intentionally narrow and testable: ",(0,r.jsx)(n.strong,{children:"for statically-defined flags and rules, the compiler\nenforces type correctness and evaluation is non-null"}),". When configuration crosses the JSON boundary, correctness is\nestablished via validation and explicit error handling (",(0,r.jsx)(n.code,{children:"ParseResult"}),"), not via compile-time guarantees."]}),"\n",(0,r.jsx)(n.mermaid,{value:'flowchart LR\n    Code["Flags + rules defined in code"] --\x3e CT["Compile-time guarantees"]\n    CT --\x3e Eval["Evaluation returns typed, non-null values"]\n    Json["JSON payload"] --\x3e RT["Runtime validation boundary"]\n    RT --\x3e|Success| Load["Namespace.load(configuration)"]\n    RT --\x3e|Failure| Reject["Reject before evaluation"]\n    style CT fill: #e1f5ff\n    style RT fill: #fff3cd\n    style Reject fill: #ffcdd2'}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"the-three-failures-of-stringly-typed-flags",children:"The three failures of stringly-typed flags"}),"\n",(0,r.jsx)(n.p,{children:"Traditional flag systems are stringly-typed: a string key selects a value and the caller chooses a typed getter. That\narchitecture introduces three classes of runtime failure:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Key mismatch"}),": ",(0,r.jsx)(n.code,{children:'"dark_mode"'})," vs ",(0,r.jsx)(n.code,{children:'"darkMode"'})," silently returns a default or null."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type mismatch"}),": retrieving a boolean flag as a string is syntactically valid but semantically wrong."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Null propagation"}),": missing configurations surface as ",(0,r.jsx)(n.code,{children:"null"})," and leak into business logic."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Konditional targets this gap: prevent categories of runtime failure by moving key/type binding into the type system."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"mechanism-1-property-delegation-binds-identity--type",children:"Mechanism 1: Property delegation binds identity + type"}),"\n",(0,r.jsxs)(n.p,{children:["Flags are delegated properties on a ",(0,r.jsx)(n.code,{children:"Namespace"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:'object AppFeatures : Namespace("app") {\n    val darkMode by boolean(default = false)\n    val timeout by double(default = 30.0)\n    val maxRetries by integer(default = 3)\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Because the delegate (",(0,r.jsx)(n.code,{children:"boolean"}),", ",(0,r.jsx)(n.code,{children:"double"}),", ",(0,r.jsx)(n.code,{children:"integer"}),", \u2026) determines the type parameter, the compiler knows the declared\ntype\nat the definition site and carries it forward."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guarantee"}),": the declared type of a feature is statically known and cannot drift without code changes the compiler\nre-checks."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"mechanism-2-rule-return-types-are-constrained",children:"Mechanism 2: Rule return types are constrained"}),"\n",(0,r.jsx)(n.p,{children:"Rules must return a value of the feature\u2019s declared type:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:"val timeout by double(default = 30.0) {\n    rule(45.0) { platforms(Platform.ANDROID) }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guarantee"}),": statically-defined rule return values are type-checked at compile time."]}),"\n",(0,r.jsx)(n.p,{children:"Boundary: this applies to rules defined in code; JSON-loaded configurations are validated at the parse boundary."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"mechanism-3-evaluation-site-preserves-the-concrete-type",children:"Mechanism 3: Evaluation site preserves the concrete type"}),"\n",(0,r.jsx)(n.p,{children:"Evaluation preserves the type parameter from definition to usage:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:'val ctx = Context(\n    locale = AppLocale.UNITED_STATES,\n    platform = Platform.IOS,\n    appVersion = Version.of(2, 1, 0),\n    stableId = StableId.of("user-123"),\n)\n\nval isDarkMode: Boolean = AppFeatures.darkMode.evaluate(ctx)\nval timeout: Double = AppFeatures.timeout.evaluate(ctx)\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guarantee"}),": no casts are required at call sites; incompatible assignments are compile errors."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"mechanism-4-required-defaults-eliminate-nulls",children:"Mechanism 4: Required defaults eliminate nulls"}),"\n",(0,r.jsx)(n.p,{children:"Every feature requires a default:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:"val darkMode by boolean(default = false)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guarantee"}),": evaluation is total\u2014if no rules match, the default is returned\u2014and does not return null."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"mechanism-5-namespace-isolation-is-structural",children:"Mechanism 5: Namespace isolation is structural"}),"\n",(0,r.jsx)(n.p,{children:"Namespaces have separate registries, and features are type-bound to their namespace:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:'sealed class AppDomain(id: String) : Namespace(id) {\n    data object Auth : AppDomain("auth") {\n        val socialLogin by boolean<Context>(default = false)\n    }\n\n    data object Payments : AppDomain("payments") {\n        val applePay by boolean<Context>(default = false)\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guarantee"}),": feature key collisions across namespaces cannot occur (separate registries bound at the type level)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Boundary"}),": defining conflicting keys within the same namespace is a design error detected at namespace initialization\n(duplicate feature ids are rejected during registration)."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"the-trust-boundary-runtime-json",children:"The trust boundary: runtime JSON"}),"\n",(0,r.jsx)(n.p,{children:"When configuration is loaded from JSON, compile-time guarantees necessarily end. Konditional establishes correctness at\nthe boundary:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:'val json = File("flags.json").readText()\nwhen (val result = AppFeatures.fromJson(json)) {\n    is ParseResult.Success -> Unit // loaded into AppFeatures\n    is ParseResult.Failure -> logError("Parse failed: ${result.error}")\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"The guarantee is qualified:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guaranteed"}),": invalid JSON is detected and rejected before it can affect evaluation."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Precondition"}),": the features referenced by the JSON must be registered (i.e., your ",(0,r.jsx)(n.code,{children:"Namespace"})," objects have\nbeen initialized)."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Not guaranteed"}),": Semantic correctness of the configuration (ramp-up percentage, targeting intent, business\ncorrectness)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary-what-is-guaranteed-vs-what-is-not",children:"Summary: what is guaranteed vs what is not"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Claim"}),(0,r.jsx)(n.th,{children:"Guarantee level"}),(0,r.jsx)(n.th,{children:"Mechanism"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"No typos in flag keys"}),(0,r.jsx)(n.td,{children:"Compile-time"}),(0,r.jsx)(n.td,{children:"property access, not strings"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Return type matches definition"}),(0,r.jsx)(n.td,{children:"Compile-time"}),(0,r.jsx)(n.td,{children:"generic type propagation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rule return types are correct"}),(0,r.jsx)(n.td,{children:"Compile-time"}),(0,r.jsx)(n.td,{children:"constrained rule DSL"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Evaluation is never null"}),(0,r.jsx)(n.td,{children:"Compile-time"}),(0,r.jsx)(n.td,{children:"required defaults"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Namespace isolation"}),(0,r.jsx)(n.td,{children:"Compile-time"}),(0,r.jsx)(n.td,{children:"type-bound containers + separate registries"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Remote config type safety"}),(0,r.jsx)(n.td,{children:"Runtime (validated boundary)"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ParseResult.Success"})," / ",(0,r.jsx)(n.code,{children:"Failure"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Semantic correctness of configs"}),(0,r.jsx)(n.td,{children:"Not guaranteed"}),(0,r.jsx)(n.td,{children:"human/process responsibility"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["See the runtime boundary mechanics: ",(0,r.jsx)(n.a,{href:"/remote-config",children:'"Remote Configuration"'})]}),"\n",(0,r.jsxs)(n.li,{children:["See deterministic behavior and concurrency claims in practice: ",(0,r.jsx)(n.a,{href:"/evaluation",children:'"Evaluation"'})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);