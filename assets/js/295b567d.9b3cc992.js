"use strict";(self.webpackChunkkonditional_docs=self.webpackChunkkonditional_docs||[]).push([[549],{48193(e,n,t){t.d(n,{R:()=>r,x:()=>l});var a=t(30758);const i={},s=a.createContext(i);function r(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}},93940(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"migration","title":"Migration Guide","description":"This guide maps the conceptual shift from string-based flags to Konditional\u2019s typed, property-based model.","source":"@site/docs/migration.md","sourceDirName":".","slug":"/migration","permalink":"/migration","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Getting Started","permalink":"/getting-started"},"next":{"title":"Core Concepts","permalink":"/core-concepts"}}');var i=t(86070),s=t(48193);const r={},l="Migration Guide",o={},d=[{value:"The core mapping",id:"the-core-mapping",level:2},{value:"Step-by-step adoption (incremental)",id:"step-by-step-adoption-incremental",level:2},{value:"0. Start with one namespace",id:"0-start-with-one-namespace",level:3},{value:"1. Replace call sites first (value safety)",id:"1-replace-call-sites-first-value-safety",level:3},{value:"2. Introduce typed context (targeting + ramp-ups)",id:"2-introduce-typed-context-targeting--ramp-ups",level:3},{value:"3. Add rules after defaults exist (behavior safety)",id:"3-add-rules-after-defaults-exist-behavior-safety",level:3},{value:"Migrating \u201ccontext maps\u201d to typed contexts",id:"migrating-context-maps-to-typed-contexts",level:2},{value:"Namespaces replace prefixes",id:"namespaces-replace-prefixes",level:2},{value:"When you need runtime configuration (remote JSON)",id:"when-you-need-runtime-configuration-remote-json",level:2},{value:"Shadow evaluation (parallel migration)",id:"shadow-evaluation-parallel-migration",level:2},{value:"Next steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"migration-guide",children:"Migration Guide"})}),"\n",(0,i.jsx)(n.p,{children:"This guide maps the conceptual shift from string-based flags to Konditional\u2019s typed, property-based model.\nIt focuses on what changes at the definition site, at the call site, and at the trust boundary (runtime JSON)."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"the-core-mapping",children:"The core mapping"}),"\n",(0,i.jsx)(n.p,{children:"String-based flag systems typically have:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["a ",(0,i.jsx)(n.strong,{children:"string key"})," (",(0,i.jsx)(n.code,{children:'"dark-mode"'}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["a ",(0,i.jsx)(n.strong,{children:"typed getter"})," chosen by the caller (",(0,i.jsx)(n.code,{children:"getBoolean"}),", ",(0,i.jsx)(n.code,{children:"getString"}),", \u2026)"]}),"\n",(0,i.jsxs)(n.li,{children:["an ",(0,i.jsx)(n.strong,{children:"untyped context"})," (often string keys and ",(0,i.jsx)(n.code,{children:"Any"})," values)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Konditional replaces those with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["a ",(0,i.jsx)(n.strong,{children:"property"})," (the property name becomes the key)"]}),"\n",(0,i.jsxs)(n.li,{children:["a ",(0,i.jsx)(n.strong,{children:"declared type"})," (from the delegate: ",(0,i.jsx)(n.code,{children:"boolean"}),", ",(0,i.jsx)(n.code,{children:"string"}),", ",(0,i.jsx)(n.code,{children:"int"}),", ",(0,i.jsx)(n.code,{children:"double"}),", ",(0,i.jsx)(n.code,{children:"enum"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["a ",(0,i.jsxs)(n.strong,{children:["typed ",(0,i.jsx)(n.code,{children:"Context"})]})," (and optionally domain-specific context data classes)"]}),"\n"]}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart LR\n    A["String key"] --\x3e B["Property name"]\n    C["Typed getter"] --\x3e D["Type flows from definition"]\n    E["Untyped context map"] --\x3e F["Typed Context data"]'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"step-by-step-adoption-incremental",children:"Step-by-step adoption (incremental)"}),"\n",(0,i.jsx)(n.h3,{id:"0-start-with-one-namespace",children:"0. Start with one namespace"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'object Features : Namespace("app") {\n    val darkMode by boolean<Context>(default = false)\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"1-replace-call-sites-first-value-safety",children:"1. Replace call sites first (value safety)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:"val enabled: Boolean = Features.darkMode.evaluate(context)\n"})}),"\n",(0,i.jsx)(n.p,{children:"What you gain immediately:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"key typos are eliminated at the call site (there is no string key)"}),"\n",(0,i.jsxs)(n.li,{children:["return type is concrete (no cast; ",(0,i.jsx)(n.code,{children:"Boolean"})," is enforced)"]}),"\n",(0,i.jsx)(n.li,{children:"evaluation is non-null (default is required)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-introduce-typed-context-targeting--ramp-ups",children:"2. Introduce typed context (targeting + ramp-ups)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val context = Context(\n    locale = AppLocale.UNITED_STATES,\n    platform = Platform.IOS,\n    appVersion = Version.parse("2.1.0"),\n    stableId = StableId.of("a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6")\n)\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"stableId"})," is the stable input used for deterministic ramp-up bucketing (\nsee ",(0,i.jsx)(n.a,{href:"/targeting-ramp-ups",children:'"Targeting & Ramp-ups"'}),")."]}),"\n",(0,i.jsx)(n.h3,{id:"3-add-rules-after-defaults-exist-behavior-safety",children:"3. Add rules after defaults exist (behavior safety)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val apiEndpoint by string<Context>(default = "https://api.example.com") {\n    rule("https://api-ios.example.com") { platforms(Platform.IOS) }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"migrating-context-maps-to-typed-contexts",children:"Migrating \u201ccontext maps\u201d to typed contexts"}),"\n",(0,i.jsxs)(n.p,{children:["If your current system uses string keys (",(0,i.jsx)(n.code,{children:'"tier"'}),", ",(0,i.jsx)(n.code,{children:'"role"'}),", \u2026), move that information into a custom context:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'data class EnterpriseContext(\n    override val locale: AppLocale,\n    override val platform: Platform,\n    override val appVersion: Version,\n    override val stableId: StableId,\n    val subscriptionTier: SubscriptionTier,\n    val employeeCount: Int\n) : Context\n\nenum class SubscriptionTier { FREE, PRO, ENTERPRISE }\n\nobject EnterpriseFeatures : Namespace("enterprise") {\n    val advancedAnalytics by boolean<EnterpriseContext>(default = false) {\n        rule(true) {\n            extension {\n                subscriptionTier == SubscriptionTier.ENTERPRISE && employeeCount > 100\n            }\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Result: business targeting logic becomes type-checked and refactor-safe."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"namespaces-replace-prefixes",children:"Namespaces replace prefixes"}),"\n",(0,i.jsxs)(n.p,{children:["Instead of ",(0,i.jsx)(n.code,{children:'"auth.dark-mode"'})," / ",(0,i.jsx)(n.code,{children:'"payments.dark-mode"'})," style prefixes, use namespace isolation:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'sealed class AppDomain(id: String) : Namespace(id) {\n    data object Auth : AppDomain("auth") {\n        val socialLogin by boolean<Context>(default = false)\n    }\n\n    data object Payments : AppDomain("payments") {\n        val applePay by boolean<Context>(default = false)\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Each namespace has its own registry and independent configuration lifecycle."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"when-you-need-runtime-configuration-remote-json",children:"When you need runtime configuration (remote JSON)"}),"\n",(0,i.jsx)(n.p,{children:"Konditional supports JSON configuration as a validated boundary:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val json = File("flags.json").readText()\nwhen (val result = AppDomain.Payments.fromJson(json)) {\n    is ParseResult.Success -> Unit // loaded into AppDomain.Payments\n    is ParseResult.Failure -> logError("Parse failed: ${result.error}")\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"The guarantee is intentionally qualified: JSON is not \u201calways safe\u201d; instead, invalid JSON is rejected before it can\naffect evaluation."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"shadow-evaluation-parallel-migration",children:"Shadow evaluation (parallel migration)"}),"\n",(0,i.jsx)(n.p,{children:"For gradual migrations, you can evaluate against a baseline registry and shadow-evaluate against a candidate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'val value = Features.darkMode.evaluateWithShadow(\n    context = context,\n    candidateRegistry = candidateRegistry,\n    onMismatch = { mismatch ->\n        log.warn("Mismatch: ${mismatch.kinds} baseline=${mismatch.baseline.value} candidate=${mismatch.candidate.value}")\n    }\n)\n'})}),"\n",(0,i.jsx)(n.p,{children:"This keeps behavior pinned to the baseline value while generating comparison telemetry for the candidate path."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Learn the primitives: ",(0,i.jsx)(n.a,{href:"/core-concepts",children:'"Core Concepts"'})]}),"\n",(0,i.jsxs)(n.li,{children:["Understand rule evaluation and determinism: ",(0,i.jsx)(n.a,{href:"/evaluation",children:'"Evaluation"'})]}),"\n",(0,i.jsxs)(n.li,{children:["Operate remote config safely: ",(0,i.jsx)(n.a,{href:"/remote-config",children:'"Remote Configuration"'})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);