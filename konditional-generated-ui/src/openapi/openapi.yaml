openapi: 3.0.3
info:
  title: Konditional Serialization Schema
  version: 0.0.1
x-konditional-samples:
  snapshotJson: |
    {
      "meta": {
        "version": "2024.12.001",
        "generatedAtEpochMillis": 1735689600000,
        "source": "openapi-sample"
      },
      "flags": [
        {
          "type": "BOOLEAN",
          "key": "feature::ui::dark_mode_enabled",
          "defaultValue": { "type": "BOOLEAN", "value": false },
          "salt": "v1",
          "isActive": true,
          "rampUpAllowlist": [],
          "rules": [
            {
              "value": { "type": "BOOLEAN", "value": true },
              "rampUp": 100,
              "rampUpAllowlist": [],
              "note": "Enable for all iOS users",
              "locales": ["UNITED_STATES", "CANADA"],
              "platforms": ["IOS"],
              "versionRange": { "type": "UNBOUNDED" },
              "axes": {}
            },
            {
              "value": { "type": "BOOLEAN", "value": true },
              "rampUp": 50,
              "rampUpAllowlist": ["beta-tester-1", "beta-tester-2"],
              "note": "Gradual rollout for Android",
              "locales": ["UNITED_STATES", "MEXICO"],
              "platforms": ["ANDROID"],
              "versionRange": { "type": "MIN_BOUND", "min": { "major": 5, "minor": 0, "patch": 0 } },
              "axes": {}
            }
          ]
        },
        {
          "type": "STRING",
          "key": "feature::onboarding::welcome_message",
          "defaultValue": { "type": "STRING", "value": "Welcome to our app!" },
          "salt": "v1",
          "isActive": true,
          "rampUpAllowlist": [],
          "rules": [
            {
              "value": { "type": "STRING", "value": "G'day mate! Welcome to the app!" },
              "rampUp": 100,
              "rampUpAllowlist": [],
              "note": "Australian localization",
              "locales": ["AUSTRALIA", "NEW_ZEALAND"],
              "platforms": ["IOS", "ANDROID", "WEB"],
              "versionRange": { "type": "UNBOUNDED" },
              "axes": {}
            },
            {
              "value": { "type": "STRING", "value": "Bienvenue dans notre application!" },
              "rampUp": 100,
              "rampUpAllowlist": [],
              "note": "French localization",
              "locales": ["FRANCE", "CANADA_FRENCH", "BELGIUM_FRENCH"],
              "platforms": ["IOS", "ANDROID", "WEB"],
              "versionRange": { "type": "UNBOUNDED" },
              "axes": {}
            }
          ]
        },
        {
          "type": "INT",
          "key": "feature::networking::max_retry_count",
          "defaultValue": { "type": "INT", "value": 3 },
          "salt": "v1",
          "isActive": true,
          "rampUpAllowlist": [],
          "rules": [
            {
              "value": { "type": "INT", "value": 5 },
              "rampUp": 100,
              "rampUpAllowlist": [],
              "note": "More retries for regions with poor connectivity",
              "locales": ["INDIA", "MEXICO"],
              "platforms": ["IOS", "ANDROID", "WEB"],
              "versionRange": { "type": "UNBOUNDED" },
              "axes": {}
            }
          ]
        },
        {
          "type": "DOUBLE",
          "key": "feature::ui::animation_speed_multiplier",
          "defaultValue": { "type": "DOUBLE", "value": 1.0 },
          "salt": "v1",
          "isActive": true,
          "rampUpAllowlist": [],
          "rules": [
            {
              "value": { "type": "DOUBLE", "value": 0.5 },
              "rampUp": 100,
              "rampUpAllowlist": [],
              "note": "Slower animations for older devices",
              "locales": ["UNITED_STATES", "CANADA"],
              "platforms": ["ANDROID"],
              "versionRange": { "type": "MAX_BOUND", "max": { "major": 3, "minor": 0, "patch": 0 } },
              "axes": {}
            }
          ]
        },
        {
          "type": "ENUM",
          "key": "feature::payments::provider",
          "defaultValue": { "type": "ENUM", "value": "STRIPE", "enumClassName": "PaymentProvider" },
          "salt": "v1",
          "isActive": true,
          "rampUpAllowlist": [],
          "rules": [
            {
              "value": { "type": "ENUM", "value": "ADYEN", "enumClassName": "PaymentProvider" },
              "rampUp": 100,
              "rampUpAllowlist": [],
              "note": "Use Adyen in European markets",
              "locales": ["FRANCE", "GERMANY", "UNITED_KINGDOM"],
              "platforms": ["IOS", "ANDROID", "WEB"],
              "versionRange": { "type": "UNBOUNDED" },
              "axes": {}
            }
          ]
        },
        {
          "type": "DATA_CLASS",
          "key": "feature::experiment::checkout_flow_config",
          "defaultValue": {
            "type": "DATA_CLASS",
            "dataClassName": "CheckoutFlowConfig",
            "value": {
              "showProgressBar": true,
              "skipReviewStep": false,
              "enableOneClick": false,
              "maxItemsPerOrder": 100
            }
          },
          "salt": "v1",
          "isActive": true,
          "rampUpAllowlist": [],
          "rules": [
            {
              "value": {
                "type": "DATA_CLASS",
                "dataClassName": "CheckoutFlowConfig",
                "value": {
                  "showProgressBar": true,
                  "skipReviewStep": true,
                  "enableOneClick": true,
                  "maxItemsPerOrder": 50
                }
              },
              "rampUp": 25,
              "rampUpAllowlist": ["power-user-1"],
              "note": "Streamlined checkout experiment",
              "locales": ["UNITED_STATES"],
              "platforms": ["WEB"],
              "versionRange": { "type": "UNBOUNDED" },
              "axes": {
                "userTier": ["premium", "enterprise"]
              }
            }
          ]
        },
        {
          "type": "BOOLEAN",
          "key": "feature::legacy::old_navigation",
          "defaultValue": { "type": "BOOLEAN", "value": true },
          "salt": "v1",
          "isActive": false,
          "rampUpAllowlist": [],
          "rules": []
        }
      ]
    }
paths:
  /snapshot:
    get:
      summary: Fetch a configuration snapshot
      responses:
        '200':
          description: Snapshot payload
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Snapshot'
components:
  schemas:
    FeatureId:
      description: 'Encoded feature identifier: feature::(namespace)::(key).'
      type: string
    Version:
      description: Semantic version representation.
      type: object
      additionalProperties: false
      properties:
        major:
          type: integer
          format: int32
          minimum: 0
        minor:
          type: integer
          format: int32
          minimum: 0
        patch:
          type: integer
          format: int32
          minimum: 0
      required:
        - major
        - minor
        - patch
    VersionRangeUnbounded:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - UNBOUNDED
      required:
        - type
    VersionRangeMinBound:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - MIN_BOUND
        min:
          description: Semantic version representation.
          type: object
          additionalProperties: false
          properties:
            major:
              type: integer
              format: int32
              minimum: 0
            minor:
              type: integer
              format: int32
              minimum: 0
            patch:
              type: integer
              format: int32
              minimum: 0
          required:
            - major
            - minor
            - patch
      required:
        - type
        - min
    VersionRangeMaxBound:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - MAX_BOUND
        max:
          description: Semantic version representation.
          type: object
          additionalProperties: false
          properties:
            major:
              type: integer
              format: int32
              minimum: 0
            minor:
              type: integer
              format: int32
              minimum: 0
            patch:
              type: integer
              format: int32
              minimum: 0
          required:
            - major
            - minor
            - patch
      required:
        - type
        - max
    VersionRangeMinAndMaxBound:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - MIN_AND_MAX_BOUND
        min:
          description: Semantic version representation.
          type: object
          additionalProperties: false
          properties:
            major:
              type: integer
              format: int32
              minimum: 0
            minor:
              type: integer
              format: int32
              minimum: 0
            patch:
              type: integer
              format: int32
              minimum: 0
          required:
            - major
            - minor
            - patch
        max:
          description: Semantic version representation.
          type: object
          additionalProperties: false
          properties:
            major:
              type: integer
              format: int32
              minimum: 0
            minor:
              type: integer
              format: int32
              minimum: 0
            patch:
              type: integer
              format: int32
              minimum: 0
          required:
            - major
            - minor
            - patch
      required:
        - type
        - min
        - max
    VersionRange:
      type: object
      required: [ type ]
      properties:
        type:
          type: string
          enum:
            - UNBOUNDED
            - MIN_BOUND
            - MAX_BOUND
            - MIN_AND_MAX_BOUND
      discriminator:
        propertyName: type
        mapping:
          UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
          MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
          MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
          MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
      oneOf:
        - $ref: '#/components/schemas/VersionRangeUnbounded'
        - $ref: '#/components/schemas/VersionRangeMinBound'
        - $ref: '#/components/schemas/VersionRangeMaxBound'
        - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
    BooleanFlagValue:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - BOOLEAN
        value:
          type: boolean
      required:
        - type
        - value
    StringFlagValue:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - STRING
        value:
          type: string
      required:
        - type
        - value
    IntFlagValue:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - INT
        value:
          type: integer
          format: int32
      required:
        - type
        - value
    DoubleFlagValue:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - DOUBLE
        value:
          type: number
          format: double
      required:
        - type
        - value
    EnumFlagValue:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - ENUM
        value:
          type: string
        enumClassName:
          type: string
      required:
        - type
        - value
        - enumClassName
    DataClassFlagValue:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - DATA_CLASS
        dataClassName:
          type: string
        value:
          type: object
          additionalProperties:
            nullable: true
      required:
        - type
        - dataClassName
        - value
    FlagValue:
      type: object
      required: [ type ]
      properties:
        type:
          type: string
          enum:
            - BOOLEAN
            - STRING
            - INT
            - DOUBLE
            - ENUM
            - DATA_CLASS

      discriminator:
        propertyName: type
        mapping:
          BOOLEAN: '#/components/schemas/BooleanFlagValue'
          STRING: '#/components/schemas/StringFlagValue'
          INT: '#/components/schemas/IntFlagValue'
          DOUBLE: '#/components/schemas/DoubleFlagValue'
          ENUM: '#/components/schemas/EnumFlagValue'
          DATA_CLASS: '#/components/schemas/DataClassFlagValue'
      oneOf:
        - $ref: '#/components/schemas/BooleanFlagValue'
        - $ref: '#/components/schemas/StringFlagValue'
        - $ref: '#/components/schemas/IntFlagValue'
        - $ref: '#/components/schemas/DoubleFlagValue'
        - $ref: '#/components/schemas/EnumFlagValue'
        - $ref: '#/components/schemas/DataClassFlagValue'
    BooleanRule:
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - BOOLEAN
            value:
              type: boolean
          required:
            - type
            - value
        rampUp:
          type: number
          format: double
          minimum: 0
          maximum: 100
          default: 100
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        note:
          type: string
        locales:
          type: string
          enum:
            - AUSTRALIA
            - AUSTRIA
            - BELGIUM_DUTCH
            - BELGIUM_FRENCH
            - CANADA
            - CANADA_FRENCH
            - FINLAND
            - FRANCE
            - GERMANY
            - HONG_KONG
            - HONG_KONG_ENGLISH
            - INDIA
            - ITALY
            - JAPAN
            - MEXICO
            - NETHERLANDS
            - NEW_ZEALAND
            - NORWAY
            - SINGAPORE
            - SPAIN
            - SWEDEN
            - TAIWAN
            - UNITED_KINGDOM
            - UNITED_STATES
            - ICC_EN_EU
            - ICC_EN_EI
          default: UNITED_STATES
        platforms:
          type: array
          items:
            type: string
          uniqueItems: true
          default:
            - IOS
            - ANDROID
            - WEB
        versionRange:
          discriminator:
            propertyName: type
            mapping:
              UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
              MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
              MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
              MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
          oneOf:
            - $ref: '#/components/schemas/VersionRangeUnbounded'
            - $ref: '#/components/schemas/VersionRangeMinBound'
            - $ref: '#/components/schemas/VersionRangeMaxBound'
            - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
          default:
            type: UNBOUNDED
        axes:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
            uniqueItems: true
          default: { }
      required:
        - value
        - rampUp
        - rampUpAllowlist
        - locales
        - platforms
        - versionRange
        - axes
    StringRule:
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - STRING
            value:
              type: string
          required:
            - type
            - value
        rampUp:
          type: number
          format: double
          minimum: 0
          maximum: 100
          default: 100
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        note:
          type: string
        locales:
          type: string
          enum:
            - AUSTRALIA
            - AUSTRIA
            - BELGIUM_DUTCH
            - BELGIUM_FRENCH
            - CANADA
            - CANADA_FRENCH
            - FINLAND
            - FRANCE
            - GERMANY
            - HONG_KONG
            - HONG_KONG_ENGLISH
            - INDIA
            - ITALY
            - JAPAN
            - MEXICO
            - NETHERLANDS
            - NEW_ZEALAND
            - NORWAY
            - SINGAPORE
            - SPAIN
            - SWEDEN
            - TAIWAN
            - UNITED_KINGDOM
            - UNITED_STATES
            - ICC_EN_EU
            - ICC_EN_EI
          default: UNITED_STATES
        platforms:
          type: array
          items:
            type: string
          uniqueItems: true
          default:
            - IOS
            - ANDROID
            - WEB
        versionRange:
          discriminator:
            propertyName: type
            mapping:
              UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
              MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
              MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
              MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
          oneOf:
            - $ref: '#/components/schemas/VersionRangeUnbounded'
            - $ref: '#/components/schemas/VersionRangeMinBound'
            - $ref: '#/components/schemas/VersionRangeMaxBound'
            - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
          default:
            type: UNBOUNDED
        axes:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
            uniqueItems: true
          default: { }
      required:
        - value
        - rampUp
        - rampUpAllowlist
        - locales
        - platforms
        - versionRange
        - axes
    IntRule:
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - INT
            value:
              type: integer
              format: int32
          required:
            - type
            - value
        rampUp:
          type: number
          format: double
          minimum: 0
          maximum: 100
          default: 100
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        note:
          type: string
        locales:
          type: string
          enum:
            - AUSTRALIA
            - AUSTRIA
            - BELGIUM_DUTCH
            - BELGIUM_FRENCH
            - CANADA
            - CANADA_FRENCH
            - FINLAND
            - FRANCE
            - GERMANY
            - HONG_KONG
            - HONG_KONG_ENGLISH
            - INDIA
            - ITALY
            - JAPAN
            - MEXICO
            - NETHERLANDS
            - NEW_ZEALAND
            - NORWAY
            - SINGAPORE
            - SPAIN
            - SWEDEN
            - TAIWAN
            - UNITED_KINGDOM
            - UNITED_STATES
            - ICC_EN_EU
            - ICC_EN_EI
          default: UNITED_STATES
        platforms:
          type: array
          items:
            type: string
          uniqueItems: true
          default:
            - IOS
            - ANDROID
            - WEB
        versionRange:
          discriminator:
            propertyName: type
            mapping:
              UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
              MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
              MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
              MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
          oneOf:
            - $ref: '#/components/schemas/VersionRangeUnbounded'
            - $ref: '#/components/schemas/VersionRangeMinBound'
            - $ref: '#/components/schemas/VersionRangeMaxBound'
            - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
          default:
            type: UNBOUNDED
        axes:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
            uniqueItems: true
          default: { }
      required:
        - value
        - rampUp
        - rampUpAllowlist
        - locales
        - platforms
        - versionRange
        - axes
    DoubleRule:
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - DOUBLE
            value:
              type: number
              format: double
          required:
            - type
            - value
        rampUp:
          type: number
          format: double
          minimum: 0
          maximum: 100
          default: 100
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        note:
          type: string
        locales:
          type: string
          enum:
            - AUSTRALIA
            - AUSTRIA
            - BELGIUM_DUTCH
            - BELGIUM_FRENCH
            - CANADA
            - CANADA_FRENCH
            - FINLAND
            - FRANCE
            - GERMANY
            - HONG_KONG
            - HONG_KONG_ENGLISH
            - INDIA
            - ITALY
            - JAPAN
            - MEXICO
            - NETHERLANDS
            - NEW_ZEALAND
            - NORWAY
            - SINGAPORE
            - SPAIN
            - SWEDEN
            - TAIWAN
            - UNITED_KINGDOM
            - UNITED_STATES
            - ICC_EN_EU
            - ICC_EN_EI
          default: UNITED_STATES
        platforms:
          type: array
          items:
            type: string
          uniqueItems: true
          default:
            - IOS
            - ANDROID
            - WEB
        versionRange:
          discriminator:
            propertyName: type
            mapping:
              UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
              MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
              MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
              MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
          oneOf:
            - $ref: '#/components/schemas/VersionRangeUnbounded'
            - $ref: '#/components/schemas/VersionRangeMinBound'
            - $ref: '#/components/schemas/VersionRangeMaxBound'
            - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
          default:
            type: UNBOUNDED
        axes:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
            uniqueItems: true
          default: { }
      required:
        - value
        - rampUp
        - rampUpAllowlist
        - locales
        - platforms
        - versionRange
        - axes
    EnumRule:
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - ENUM
            value:
              type: string
            enumClassName:
              type: string
          required:
            - type
            - value
            - enumClassName
        rampUp:
          type: number
          format: double
          minimum: 0
          maximum: 100
          default: 100
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        note:
          type: string
        locales:
          type: string
          enum:
            - AUSTRALIA
            - AUSTRIA
            - BELGIUM_DUTCH
            - BELGIUM_FRENCH
            - CANADA
            - CANADA_FRENCH
            - FINLAND
            - FRANCE
            - GERMANY
            - HONG_KONG
            - HONG_KONG_ENGLISH
            - INDIA
            - ITALY
            - JAPAN
            - MEXICO
            - NETHERLANDS
            - NEW_ZEALAND
            - NORWAY
            - SINGAPORE
            - SPAIN
            - SWEDEN
            - TAIWAN
            - UNITED_KINGDOM
            - UNITED_STATES
            - ICC_EN_EU
            - ICC_EN_EI
          default: UNITED_STATES
        platforms:
          type: array
          items:
            type: string
          uniqueItems: true
          default:
            - IOS
            - ANDROID
            - WEB
        versionRange:
          discriminator:
            propertyName: type
            mapping:
              UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
              MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
              MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
              MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
          oneOf:
            - $ref: '#/components/schemas/VersionRangeUnbounded'
            - $ref: '#/components/schemas/VersionRangeMinBound'
            - $ref: '#/components/schemas/VersionRangeMaxBound'
            - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
          default:
            type: UNBOUNDED
        axes:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
            uniqueItems: true
          default: { }
      required:
        - value
        - rampUp
        - rampUpAllowlist
        - locales
        - platforms
        - versionRange
        - axes
    DataClassRule:
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - DATA_CLASS
            dataClassName:
              type: string
            value:
              type: object
              additionalProperties:
                nullable: true
          required:
            - type
            - dataClassName
            - value
        rampUp:
          type: number
          format: double
          minimum: 0
          maximum: 100
          default: 100
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        note:
          type: string
        locales:
          type: string
          enum:
            - AUSTRALIA
            - AUSTRIA
            - BELGIUM_DUTCH
            - BELGIUM_FRENCH
            - CANADA
            - CANADA_FRENCH
            - FINLAND
            - FRANCE
            - GERMANY
            - HONG_KONG
            - HONG_KONG_ENGLISH
            - INDIA
            - ITALY
            - JAPAN
            - MEXICO
            - NETHERLANDS
            - NEW_ZEALAND
            - NORWAY
            - SINGAPORE
            - SPAIN
            - SWEDEN
            - TAIWAN
            - UNITED_KINGDOM
            - UNITED_STATES
            - ICC_EN_EU
            - ICC_EN_EI
          default: UNITED_STATES
        platforms:
          type: array
          items:
            type: string
          uniqueItems: true
          default:
            - IOS
            - ANDROID
            - WEB
        versionRange:
          discriminator:
            propertyName: type
            mapping:
              UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
              MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
              MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
              MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
          oneOf:
            - $ref: '#/components/schemas/VersionRangeUnbounded'
            - $ref: '#/components/schemas/VersionRangeMinBound'
            - $ref: '#/components/schemas/VersionRangeMaxBound'
            - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
          default:
            type: UNBOUNDED
        axes:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
            uniqueItems: true
          default: { }
      required:
        - value
        - rampUp
        - rampUpAllowlist
        - locales
        - platforms
        - versionRange
        - axes
    Flag:
      type: object
      required: [ type ]
      properties:
        type:
          type: string
          enum:
            - BOOLEAN
            - STRING
            - INT
            - DOUBLE
            - ENUM
            - DATA_CLASS
      discriminator:
        propertyName: type
        mapping:
          BOOLEAN: '#/components/schemas/BooleanFlag'
          STRING: '#/components/schemas/StringFlag'
          INT: '#/components/schemas/IntFlag'
          DOUBLE: '#/components/schemas/DoubleFlag'
          ENUM: '#/components/schemas/EnumFlag'
          DATA_CLASS: '#/components/schemas/DataClassFlag'
      oneOf:
        - $ref: '#/components/schemas/BooleanFlag'
        - $ref: '#/components/schemas/StringFlag'
        - $ref: '#/components/schemas/IntFlag'
        - $ref: '#/components/schemas/DoubleFlag'
        - $ref: '#/components/schemas/EnumFlag'
        - $ref: '#/components/schemas/DataClassFlag'
    BooleanFlag:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - BOOLEAN
        key:
          description: 'Encoded feature identifier: feature::(namespace)::(key).'
          type: string
        defaultValue:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - BOOLEAN
            value:
              type: boolean
          required:
            - type
            - value
        salt:
          type: string
          default: v1
        isActive:
          type: boolean
          default: true
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        rules:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              value:
                type: object
                additionalProperties: false
                properties:
                  type:
                    type: string
                    enum:
                      - BOOLEAN
                  value:
                    type: boolean
                required:
                  - type
                  - value
              rampUp:
                type: number
                format: double
                minimum: 0
                maximum: 100
                default: 100
              rampUpAllowlist:
                type: array
                items:
                  type: string
                uniqueItems: true
                default: [ ]
              note:
                type: string
              locales:
                type: string
                enum:
                  - AUSTRALIA
                  - AUSTRIA
                  - BELGIUM_DUTCH
                  - BELGIUM_FRENCH
                  - CANADA
                  - CANADA_FRENCH
                  - FINLAND
                  - FRANCE
                  - GERMANY
                  - HONG_KONG
                  - HONG_KONG_ENGLISH
                  - INDIA
                  - ITALY
                  - JAPAN
                  - MEXICO
                  - NETHERLANDS
                  - NEW_ZEALAND
                  - NORWAY
                  - SINGAPORE
                  - SPAIN
                  - SWEDEN
                  - TAIWAN
                  - UNITED_KINGDOM
                  - UNITED_STATES
                  - ICC_EN_EU
                  - ICC_EN_EI
                default: UNITED_STATES
              platforms:
                type: array
                items:
                  type: string
                uniqueItems: true
                default:
                  - IOS
                  - ANDROID
                  - WEB
              versionRange:
                discriminator:
                  propertyName: type
                  mapping:
                    UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
                    MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
                    MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
                    MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
                oneOf:
                  - $ref: '#/components/schemas/VersionRangeUnbounded'
                  - $ref: '#/components/schemas/VersionRangeMinBound'
                  - $ref: '#/components/schemas/VersionRangeMaxBound'
                  - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
                default:
                  type: UNBOUNDED
              axes:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
                  uniqueItems: true
                default: { }
            required:
              - value
              - rampUp
              - rampUpAllowlist
              - locales
              - platforms
              - versionRange
              - axes
          default: [ ]
      required:
        - type
        - key
        - defaultValue
        - salt
        - isActive
        - rampUpAllowlist
        - rules
    StringFlag:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - STRING
        key:
          description: 'Encoded feature identifier: feature::(namespace)::(key).'
          type: string
        defaultValue:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - STRING
            value:
              type: string
          required:
            - type
            - value
        salt:
          type: string
          default: v1
        isActive:
          type: boolean
          default: true
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        rules:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              value:
                type: object
                additionalProperties: false
                properties:
                  type:
                    type: string
                    enum:
                      - STRING
                  value:
                    type: string
                required:
                  - type
                  - value
              rampUp:
                type: number
                format: double
                minimum: 0
                maximum: 100
                default: 100
              rampUpAllowlist:
                type: array
                items:
                  type: string
                uniqueItems: true
                default: [ ]
              note:
                type: string
              locales:
                type: string
                enum:
                  - AUSTRALIA
                  - AUSTRIA
                  - BELGIUM_DUTCH
                  - BELGIUM_FRENCH
                  - CANADA
                  - CANADA_FRENCH
                  - FINLAND
                  - FRANCE
                  - GERMANY
                  - HONG_KONG
                  - HONG_KONG_ENGLISH
                  - INDIA
                  - ITALY
                  - JAPAN
                  - MEXICO
                  - NETHERLANDS
                  - NEW_ZEALAND
                  - NORWAY
                  - SINGAPORE
                  - SPAIN
                  - SWEDEN
                  - TAIWAN
                  - UNITED_KINGDOM
                  - UNITED_STATES
                  - ICC_EN_EU
                  - ICC_EN_EI
                default: UNITED_STATES
              platforms:
                type: array
                items:
                  type: string
                uniqueItems: true
                default:
                  - IOS
                  - ANDROID
                  - WEB
              versionRange:
                discriminator:
                  propertyName: type
                  mapping:
                    UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
                    MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
                    MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
                    MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
                oneOf:
                  - $ref: '#/components/schemas/VersionRangeUnbounded'
                  - $ref: '#/components/schemas/VersionRangeMinBound'
                  - $ref: '#/components/schemas/VersionRangeMaxBound'
                  - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
                default:
                  type: UNBOUNDED
              axes:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
                  uniqueItems: true
                default: { }
            required:
              - value
              - rampUp
              - rampUpAllowlist
              - locales
              - platforms
              - versionRange
              - axes
          default: [ ]
      required:
        - type
        - key
        - defaultValue
        - salt
        - isActive
        - rampUpAllowlist
        - rules
    IntFlag:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - INT
        key:
          description: 'Encoded feature identifier: feature::(namespace)::(key).'
          type: string
        defaultValue:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - INT
            value:
              type: integer
              format: int32
          required:
            - type
            - value
        salt:
          type: string
          default: v1
        isActive:
          type: boolean
          default: true
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        rules:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              value:
                type: object
                additionalProperties: false
                properties:
                  type:
                    type: string
                    enum:
                      - INT
                  value:
                    type: integer
                    format: int32
                required:
                  - type
                  - value
              rampUp:
                type: number
                format: double
                minimum: 0
                maximum: 100
                default: 100
              rampUpAllowlist:
                type: array
                items:
                  type: string
                uniqueItems: true
                default: [ ]
              note:
                type: string
              locales:
                type: string
                enum:
                  - AUSTRALIA
                  - AUSTRIA
                  - BELGIUM_DUTCH
                  - BELGIUM_FRENCH
                  - CANADA
                  - CANADA_FRENCH
                  - FINLAND
                  - FRANCE
                  - GERMANY
                  - HONG_KONG
                  - HONG_KONG_ENGLISH
                  - INDIA
                  - ITALY
                  - JAPAN
                  - MEXICO
                  - NETHERLANDS
                  - NEW_ZEALAND
                  - NORWAY
                  - SINGAPORE
                  - SPAIN
                  - SWEDEN
                  - TAIWAN
                  - UNITED_KINGDOM
                  - UNITED_STATES
                  - ICC_EN_EU
                  - ICC_EN_EI
                default: UNITED_STATES
              platforms:
                type: array
                items:
                  type: string
                uniqueItems: true
                default:
                  - IOS
                  - ANDROID
                  - WEB
              versionRange:
                discriminator:
                  propertyName: type
                  mapping:
                    UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
                    MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
                    MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
                    MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
                oneOf:
                  - $ref: '#/components/schemas/VersionRangeUnbounded'
                  - $ref: '#/components/schemas/VersionRangeMinBound'
                  - $ref: '#/components/schemas/VersionRangeMaxBound'
                  - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
                default:
                  type: UNBOUNDED
              axes:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
                  uniqueItems: true
                default: { }
            required:
              - value
              - rampUp
              - rampUpAllowlist
              - locales
              - platforms
              - versionRange
              - axes
          default: [ ]
      required:
        - type
        - key
        - defaultValue
        - salt
        - isActive
        - rampUpAllowlist
        - rules
    DoubleFlag:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - DOUBLE
        key:
          description: 'Encoded feature identifier: feature::(namespace)::(key).'
          type: string
        defaultValue:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - DOUBLE
            value:
              type: number
              format: double
          required:
            - type
            - value
        salt:
          type: string
          default: v1
        isActive:
          type: boolean
          default: true
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        rules:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              value:
                type: object
                additionalProperties: false
                properties:
                  type:
                    type: string
                    enum:
                      - DOUBLE
                  value:
                    type: number
                    format: double
                required:
                  - type
                  - value
              rampUp:
                type: number
                format: double
                minimum: 0
                maximum: 100
                default: 100
              rampUpAllowlist:
                type: array
                items:
                  type: string
                uniqueItems: true
                default: [ ]
              note:
                type: string
              locales:
                type: string
                enum:
                  - AUSTRALIA
                  - AUSTRIA
                  - BELGIUM_DUTCH
                  - BELGIUM_FRENCH
                  - CANADA
                  - CANADA_FRENCH
                  - FINLAND
                  - FRANCE
                  - GERMANY
                  - HONG_KONG
                  - HONG_KONG_ENGLISH
                  - INDIA
                  - ITALY
                  - JAPAN
                  - MEXICO
                  - NETHERLANDS
                  - NEW_ZEALAND
                  - NORWAY
                  - SINGAPORE
                  - SPAIN
                  - SWEDEN
                  - TAIWAN
                  - UNITED_KINGDOM
                  - UNITED_STATES
                  - ICC_EN_EU
                  - ICC_EN_EI
                default: UNITED_STATES
              platforms:
                type: array
                items:
                  type: string
                uniqueItems: true
                default:
                  - IOS
                  - ANDROID
                  - WEB
              versionRange:
                discriminator:
                  propertyName: type
                  mapping:
                    UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
                    MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
                    MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
                    MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
                oneOf:
                  - $ref: '#/components/schemas/VersionRangeUnbounded'
                  - $ref: '#/components/schemas/VersionRangeMinBound'
                  - $ref: '#/components/schemas/VersionRangeMaxBound'
                  - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
                default:
                  type: UNBOUNDED
              axes:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
                  uniqueItems: true
                default: { }
            required:
              - value
              - rampUp
              - rampUpAllowlist
              - locales
              - platforms
              - versionRange
              - axes
          default: [ ]
      required:
        - type
        - key
        - defaultValue
        - salt
        - isActive
        - rampUpAllowlist
        - rules
    EnumFlag:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - ENUM
        key:
          description: 'Encoded feature identifier: feature::(namespace)::(key).'
          type: string
        defaultValue:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - ENUM
            value:
              type: string
            enumClassName:
              type: string
          required:
            - type
            - value
            - enumClassName
        salt:
          type: string
          default: v1
        isActive:
          type: boolean
          default: true
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        rules:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              value:
                type: object
                additionalProperties: false
                properties:
                  type:
                    type: string
                    enum:
                      - ENUM
                  value:
                    type: string
                  enumClassName:
                    type: string
                required:
                  - type
                  - value
                  - enumClassName
              rampUp:
                type: number
                format: double
                minimum: 0
                maximum: 100
                default: 100
              rampUpAllowlist:
                type: array
                items:
                  type: string
                uniqueItems: true
                default: [ ]
              note:
                type: string
              locales:
                type: string
                enum:
                  - AUSTRALIA
                  - AUSTRIA
                  - BELGIUM_DUTCH
                  - BELGIUM_FRENCH
                  - CANADA
                  - CANADA_FRENCH
                  - FINLAND
                  - FRANCE
                  - GERMANY
                  - HONG_KONG
                  - HONG_KONG_ENGLISH
                  - INDIA
                  - ITALY
                  - JAPAN
                  - MEXICO
                  - NETHERLANDS
                  - NEW_ZEALAND
                  - NORWAY
                  - SINGAPORE
                  - SPAIN
                  - SWEDEN
                  - TAIWAN
                  - UNITED_KINGDOM
                  - UNITED_STATES
                  - ICC_EN_EU
                  - ICC_EN_EI
                default: UNITED_STATES
              platforms:
                type: array
                items:
                  type: string
                uniqueItems: true
                default:
                  - IOS
                  - ANDROID
                  - WEB
              versionRange:
                discriminator:
                  propertyName: type
                  mapping:
                    UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
                    MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
                    MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
                    MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
                oneOf:
                  - $ref: '#/components/schemas/VersionRangeUnbounded'
                  - $ref: '#/components/schemas/VersionRangeMinBound'
                  - $ref: '#/components/schemas/VersionRangeMaxBound'
                  - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
                default:
                  type: UNBOUNDED
              axes:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
                  uniqueItems: true
                default: { }
            required:
              - value
              - rampUp
              - rampUpAllowlist
              - locales
              - platforms
              - versionRange
              - axes
          default: [ ]
      required:
        - type
        - key
        - defaultValue
        - salt
        - isActive
        - rampUpAllowlist
        - rules
    DataClassFlag:
      type: object
      additionalProperties: false
      properties:
        type:
          type: string
          enum:
            - DATA_CLASS
        key:
          description: 'Encoded feature identifier: feature::(namespace)::(key).'
          type: string
        defaultValue:
          type: object
          additionalProperties: false
          properties:
            type:
              type: string
              enum:
                - DATA_CLASS
            dataClassName:
              type: string
            value:
              type: object
              additionalProperties:
                nullable: true
          required:
            - type
            - dataClassName
            - value
        salt:
          type: string
          default: v1
        isActive:
          type: boolean
          default: true
        rampUpAllowlist:
          type: array
          items:
            type: string
          uniqueItems: true
          default: [ ]
        rules:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              value:
                type: object
                additionalProperties: false
                properties:
                  type:
                    type: string
                    enum:
                      - DATA_CLASS
                  dataClassName:
                    type: string
                  value:
                    type: object
                    additionalProperties:
                      nullable: true
                required:
                  - type
                  - dataClassName
                  - value
              rampUp:
                type: number
                format: double
                minimum: 0
                maximum: 100
                default: 100
              rampUpAllowlist:
                type: array
                items:
                  type: string
                uniqueItems: true
                default: [ ]
              note:
                type: string
              locales:
                type: string
                enum:
                  - AUSTRALIA
                  - AUSTRIA
                  - BELGIUM_DUTCH
                  - BELGIUM_FRENCH
                  - CANADA
                  - CANADA_FRENCH
                  - FINLAND
                  - FRANCE
                  - GERMANY
                  - HONG_KONG
                  - HONG_KONG_ENGLISH
                  - INDIA
                  - ITALY
                  - JAPAN
                  - MEXICO
                  - NETHERLANDS
                  - NEW_ZEALAND
                  - NORWAY
                  - SINGAPORE
                  - SPAIN
                  - SWEDEN
                  - TAIWAN
                  - UNITED_KINGDOM
                  - UNITED_STATES
                  - ICC_EN_EU
                  - ICC_EN_EI
                default: UNITED_STATES
              platforms:
                type: array
                items:
                  type: string
                uniqueItems: true
                default:
                  - IOS
                  - ANDROID
                  - WEB
              versionRange:
                discriminator:
                  propertyName: type
                  mapping:
                    UNBOUNDED: '#/components/schemas/VersionRangeUnbounded'
                    MIN_BOUND: '#/components/schemas/VersionRangeMinBound'
                    MAX_BOUND: '#/components/schemas/VersionRangeMaxBound'
                    MIN_AND_MAX_BOUND: '#/components/schemas/VersionRangeMinAndMaxBound'
                oneOf:
                  - $ref: '#/components/schemas/VersionRangeUnbounded'
                  - $ref: '#/components/schemas/VersionRangeMinBound'
                  - $ref: '#/components/schemas/VersionRangeMaxBound'
                  - $ref: '#/components/schemas/VersionRangeMinAndMaxBound'
                default:
                  type: UNBOUNDED
              axes:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
                  uniqueItems: true
                default: { }
            required:
              - value
              - rampUp
              - rampUpAllowlist
              - locales
              - platforms
              - versionRange
              - axes
          default: [ ]
      required:
        - type
        - key
        - defaultValue
        - salt
        - isActive
        - rampUpAllowlist
        - rules
    SnapshotMetadata:
      type: object
      additionalProperties: false
      properties:
        version:
          type: string
        generatedAtEpochMillis:
          type: number
          format: int64
          minimum: 0
        source:
          type: string
    Snapshot:
      type: object
      additionalProperties: false
      properties:
        meta:
          $ref: '#/components/schemas/SnapshotMetadata'
        flags:
          type: array
          items:
            $ref: '#/components/schemas/Flag'

      required:
        - flags
    Patch:
      type: object
      additionalProperties: false
      properties:
        meta:
          type: object
          additionalProperties: false
          properties:
            version:
              type: string
            generatedAtEpochMillis:
              type: number
              format: int64
              minimum: 0
            source:
              type: string
        flags:
          type: array
          items:
            $ref: '#/components/schemas/Flag'
        removeKeys:
          type: array
          items:
            description: 'Encoded feature identifier: feature::(namespace)::(key).'
            type: string
          default: [ ]
      required:
        - flags
        - removeKeys
